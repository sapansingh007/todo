<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>View Shared Screen</title>
    <link rel="stylesheet" href="/styles.css" />
</head>

<body>
    <main class="container">
        <h1 id="pageTitle">View Shared Screen</h1>
        <p id="status">Connecting...</p>
        <div class="videoWrap">
            <video id="remoteVideo" autoplay playsinline muted class="remoteVideo"></video>
            <div id="playOverlay" class="playOverlay" style="display:none;">Tap to start</div>
        </div>

        <div class="viewer-controls">
            <button id="screenshotBtn">Take Screenshot</button>
            <span id="screenshotLoading" style="display:none; margin-left:8px;"></span>
            <button id="reconnectBtn" style="display:none;">Reconnect</button>
        </div>

        <section id="screenshots">
            <h2>Captured Screenshots</h2>
            <div id="shots"></div>
        </section>

        <section id="ocrSection">
            <h2>Extracted Text (OCR)</h2>
            <div id="ocrControls">
                <!-- For privacy we keep OCR results in-memory and show only filtered extraction below -->
                <div style="font-size:13px; color:#666; margin-bottom:6px;">OCR Provider: OCR.space (paste API key
                    below)</div>
                <input id="ocrSpaceKey" placeholder="Paste OCR.space API key (keeps key local to your browser)" />
                <textarea id="ocrText" rows="6" readonly style="display:none;"
                    placeholder="(raw OCR suppressed for privacy)"></textarea>
                <div class="ocr-actions">
                    <button id="copyTextBtn">Copy</button>
                    <button id="shareTextBtn">Share</button>
                    <button id="clearTextBtn">Clear</button>
                </div>
            </div>
        </section>
        <section id="extractSection">
            <h2>Extraction</h2>
            <div id="extractControls">
                <label>Mode:
                    <select id="extractMode">
                        <option value="fulltext">Full Text</option>
                        <option value="regex">Regex</option>
                        <option value="ai">AI Assist (requires endpoint)</option>
                    </select>
                </label>
                <div id="modeFulltext" class="extract-mode">
                    <div style="font-size:13px; color:#444;">Returns the full OCR text output.</div>
                </div>
                +
                <div id="modeRegex" class="extract-mode" style="display:none;">
                    <input id="regexInput" placeholder="Enter JS regex (e.g., /\\b\\d{4}-\\d{2}-\\d{2}\\b/g)" />
                </div>
                <div id="modeAI" class="extract-mode" style="display:none;">
                    <input id="aiEndpoint" placeholder="AI endpoint URL (POST)" />
                    <input id="aiPrompt" placeholder="Request prompt / instruction (optional)" />
                </div>
                + <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
                    <button id="extractBtn">Extract</button>
                    <span id="extractLoading" style="display:none;"></span>
                    +
                </div>
                + <div id="extractResult" style="margin-top:8px;"></div>
                +
            </div>
            +
        </section>
    </main>
    <!-- Tesseract.js from CDN (lazy-heavy; used only when performing OCR) -->
    <script src="https://unpkg.com/tesseract.js@4.1.1/dist/tesseract.min.js"></script>
    <script src="/viewer.js"></script>
</body>

</html>